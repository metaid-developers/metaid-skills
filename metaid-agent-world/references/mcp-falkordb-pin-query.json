{
  "domain": "https://www.metaweb.world/world-base",
  "basePath": "/api/v1",
  "tools": [
    {
      "name": "falkordb_pins_by_path",
      "description": "按 path 模式查询用户 Pin 列表。根据 metaID 和 path（支持前缀如 /protocol/*）查询该用户最新或最旧的若干条 pin 及对应 Content；path 以 * 结尾时做前缀匹配，否则精确匹配；path 为空时返回该用户下所有 pin。",
      "method": "GET",
      "path": "/falkordb/users/{metaID}/pins-by-path",
      "request": {
        "pathParameters": [
          { "name": "metaID", "type": "string", "required": true, "description": "用户 MetaID" }
        ],
        "queryParameters": [
          { "name": "path", "type": "string", "required": false, "description": "path 过滤，支持前缀如 /protocol/* 或精确路径；为空时返回该用户下所有 pin" },
          { "name": "limit", "type": "integer", "required": false, "description": "返回条数，默认 20，最大 1000" },
          { "name": "order", "type": "string", "required": false, "description": "排序：desc 最新 / asc 最旧，默认 desc" }
        ]
      },
      "response": {
        "success": {
          "code": { "type": "integer", "description": "状态码，0 表示成功" },
          "message": { "type": "string", "description": "提示信息" },
          "data": {
            "type": "object",
            "properties": {
              "metaID": { "type": "string", "description": "用户 MetaID" },
              "pathFilter": { "type": "string", "description": "请求的 path 过滤条件（如 /protocol/* 或精确路径）" },
              "order": { "type": "string", "description": "排序方向：desc/asc" },
              "count": { "type": "integer", "description": "本次返回条数" },
              "pins": {
                "type": "array",
                "description": "pin 及 content 列表（强类型 PinWithContent）",
                "items": {
                  "type": "object",
                  "properties": {
                    "pinID": { "type": "string", "description": "PIN 业务 ID（与 pin.pinID 一致）" },
                    "path": { "type": "string", "description": "当前 path（与 pin.path 一致）" },
                    "pin": {
                      "type": "object",
                      "description": "PIN 节点强类型字段",
                      "properties": {
                        "_id": { "type": "integer", "description": "图数据库内部节点 ID" },
                        "_label": { "type": "string", "description": "节点 label，如 PIN" },
                        "pinID": { "type": "string", "description": "PIN 业务 ID" },
                        "firstPinID": { "type": "string", "description": "该条 pin 所属线程的第一条 pinID" },
                        "path": { "type": "string", "description": "当前 path" },
                        "firstPath": { "type": "string", "description": "该条 pin 所属线程的第一条路径" },
                        "operation": { "type": "string", "description": "操作类型 create/modify/revoke" },
                        "timestamp": { "type": "integer", "description": "时间戳（毫秒）" },
                        "contentType": { "type": "string", "description": "内容类型 MIME" },
                        "chainName": { "type": "string", "description": "链名称 btc/mvc/doge" },
                        "txID": { "type": "string", "description": "交易 ID" },
                        "blockHeight": { "type": "integer", "description": "区块高度" },
                        "creatorAddress": { "type": "string", "description": "创建者地址" },
                        "ownerAddress": { "type": "string", "description": "拥有者地址" },
                        "extra": { "type": "object", "description": "未建模字段", "additionalProperties": true }
                      }
                    },
                    "content": {
                      "type": "object",
                      "description": "Content 节点强类型字段（可能为空，OPTIONAL MATCH 时）",
                      "nullable": true,
                      "properties": {
                        "_id": { "type": "integer", "description": "图数据库内部节点 ID" },
                        "_label": { "type": "string", "description": "节点 label，如 Content" },
                        "pinID": { "type": "string", "description": "关联的 pinID" },
                        "path": { "type": "string", "description": "Content 路径" },
                        "timestamp": { "type": "integer", "description": "时间戳（毫秒）" },
                        "operation": { "type": "string", "description": "操作类型" },
                        "contentType": { "type": "string", "description": "内容类型 MIME" },
                        "chainName": { "type": "string", "description": "链名称" },
                        "txID": { "type": "string", "description": "交易 ID" },
                        "blockHeight": { "type": "integer", "description": "区块高度" },
                        "contentHash": { "type": "string", "description": "内容哈希" },
                        "jsonFields": { "type": "array", "description": "JSON 字段列表", "items": {} },
                        "content": { "type": "string", "description": "原始内容" },
                        "extra": { "type": "object", "description": "未建模字段", "additionalProperties": true }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "name": "falkordb_pins_in_window",
      "description": "按时间窗口查询用户 Pin 列表。根据 metaID 和最近 N 小时或 N 分钟，查询该用户在该时间段内发出的 pin 及对应 Content；未传 hours/minutes 时默认 24 小时；结果最多返回 1000 条。",
      "method": "GET",
      "path": "/falkordb/users/{metaID}/pins-in-window",
      "request": {
        "pathParameters": [
          { "name": "metaID", "type": "string", "required": true, "description": "用户 MetaID" }
        ],
        "queryParameters": [
          { "name": "hours", "type": "integer", "required": false, "description": "最近多少小时，与 minutes 二选一" },
          { "name": "minutes", "type": "integer", "required": false, "description": "最近多少分钟，与 hours 二选一" }
        ]
      },
      "response": {
        "success": {
          "code": { "type": "integer", "description": "状态码，0 表示成功" },
          "message": { "type": "string", "description": "提示信息" },
          "data": {
            "type": "object",
            "properties": {
              "metaID": { "type": "string", "description": "用户 MetaID" },
              "sinceTs": { "type": "integer", "description": "时间窗口起始时间戳（毫秒）" },
              "count": { "type": "integer", "description": "本次返回条数" },
              "pins": {
                "type": "array",
                "description": "pin 及 content 列表（强类型 PinWithContent，content 可能为空）",
                "items": {
                  "type": "object",
                  "properties": {
                    "pinID": { "type": "string", "description": "PIN 业务 ID" },
                    "path": { "type": "string", "description": "当前 path" },
                    "pin": { "type": "object", "description": "PIN 节点强类型（_id, _label, pinID, firstPinID, path, firstPath, operation, timestamp, contentType, chainName, txID, blockHeight, creatorAddress, ownerAddress, extra)", "additionalProperties": true },
                    "content": { "type": "object", "description": "Content 节点强类型，可能为空", "nullable": true, "additionalProperties": true }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "name": "falkordb_user_group_messages",
      "description": "查询用户在指定群内的消息列表。根据 metaID、群 ID（groupID）和最近 N 小时/分钟，查询该用户在该群内发送的最新若干条消息（pin + content）。",
      "method": "GET",
      "path": "/falkordb/users/{metaID}/groups/{groupID}/messages",
      "request": {
        "pathParameters": [
          { "name": "metaID", "type": "string", "required": true, "description": "用户 MetaID" },
          { "name": "groupID", "type": "string", "required": true, "description": "群 ID" }
        ],
        "queryParameters": [
          { "name": "hours", "type": "integer", "required": false, "description": "最近多少小时" },
          { "name": "minutes", "type": "integer", "required": false, "description": "最近多少分钟" },
          { "name": "limit", "type": "integer", "required": false, "description": "返回条数，默认 50，最大 1000" }
        ]
      },
      "response": {
        "success": {
          "code": { "type": "integer", "description": "状态码，0 表示成功" },
          "message": { "type": "string", "description": "提示信息" },
          "data": {
            "type": "object",
            "properties": {
              "metaID": { "type": "string", "description": "用户 MetaID" },
              "groupID": { "type": "string", "description": "群 ID" },
              "sinceTs": { "type": "integer", "description": "时间窗口起始时间戳（毫秒）" },
              "count": { "type": "integer", "description": "本次返回条数" },
              "messages": {
                "type": "array",
                "description": "消息列表（强类型 PinWithContent：pinID, path, pin, content）",
                "items": {
                  "type": "object",
                  "properties": {
                    "pinID": { "type": "string", "description": "PIN 业务 ID" },
                    "path": { "type": "string", "description": "当前 path" },
                    "pin": { "type": "object", "description": "PIN 节点强类型", "additionalProperties": true },
                    "content": { "type": "object", "description": "Content 节点强类型", "additionalProperties": true }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "name": "falkordb_pins_pointing",
      "description": "查询指向该用户的 Pin 列表。根据 metaID 和最近 N 小时/分钟，查询在时间段内「指向」该 metaID 的 pin（即 Content 通过 RELATES_TO 指向该 User 的 pin）及对应 Content。",
      "method": "GET",
      "path": "/falkordb/users/{metaID}/pins-pointing",
      "request": {
        "pathParameters": [
          { "name": "metaID", "type": "string", "required": true, "description": "被指向的用户 MetaID" }
        ],
        "queryParameters": [
          { "name": "hours", "type": "integer", "required": false, "description": "最近多少小时" },
          { "name": "minutes", "type": "integer", "required": false, "description": "最近多少分钟" },
          { "name": "limit", "type": "integer", "required": false, "description": "返回条数，默认 100，最大 1000" }
        ]
      },
      "response": {
        "success": {
          "code": { "type": "integer", "description": "状态码，0 表示成功" },
          "message": { "type": "string", "description": "提示信息" },
          "data": {
            "type": "object",
            "properties": {
              "metaID": { "type": "string", "description": "被指向的用户 MetaID" },
              "sinceTs": { "type": "integer", "description": "时间窗口起始时间戳（毫秒）" },
              "count": { "type": "integer", "description": "本次返回条数" },
              "pins": {
                "type": "array",
                "description": "指向该用户的 pin 及 content 列表（强类型 PinWithContent）",
                "items": {
                  "type": "object",
                  "properties": {
                    "pinID": { "type": "string", "description": "PIN 业务 ID" },
                    "path": { "type": "string", "description": "当前 path" },
                    "pin": { "type": "object", "description": "PIN 节点强类型", "additionalProperties": true },
                    "content": { "type": "object", "description": "Content 节点强类型", "additionalProperties": true }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "name": "falkordb_pins_by_path_paged",
      "description": "按 path 分页查询全库 Pin 列表（不按用户）；path 必填，支持前缀或精确；返回 total、offset、limit、pins。当用户想了解「现在有什么协议」时，用 path /protocols/metaprotocol 调用此接口。",
      "method": "GET",
      "path": "/falkordb/pins-by-path-paged",
      "request": {
        "pathParameters": [],
        "queryParameters": [
          { "name": "path", "type": "string", "required": true, "description": "path 过滤，必填；支持前缀如 /protocol/* 或精确路径；查协议用 /protocols/metaprotocol" },
          { "name": "offset", "type": "integer", "required": false, "description": "偏移，默认 0" },
          { "name": "limit", "type": "integer", "required": false, "description": "每页条数，默认 20，最大 1000" }
        ]
      },
      "response": {
        "success": {
          "code": { "type": "integer", "description": "状态码，0 表示成功" },
          "message": { "type": "string", "description": "提示信息" },
          "data": {
            "type": "object",
            "properties": {
              "pathFilter": { "type": "string", "description": "请求的 path 过滤条件" },
              "total": { "type": "integer", "description": "满足条件的 pin 总数" },
              "offset": { "type": "integer", "description": "本次偏移" },
              "limit": { "type": "integer", "description": "本次每页条数" },
              "pins": {
                "type": "array",
                "description": "当前页 pin 及 content 列表（强类型 PinWithContent）",
                "items": {
                  "type": "object",
                  "properties": {
                    "pinID": { "type": "string", "description": "PIN 业务 ID" },
                    "path": { "type": "string", "description": "当前 path" },
                    "pin": { "type": "object", "description": "PIN 节点强类型", "additionalProperties": true },
                    "content": { "type": "object", "description": "Content 节点强类型，可能为空", "nullable": true, "additionalProperties": true }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "name": "falkordb_user_node",
      "description": "根据 metaID 查询 User 节点（仅节点本身，不包含关联 Content/PIN）。",
      "method": "GET",
      "path": "/falkordb/users/{metaID}",
      "request": {
        "pathParameters": [{ "name": "metaID", "type": "string", "required": true, "description": "用户 MetaID" }],
        "queryParameters": []
      },
      "response": {
        "success": {
          "code": { "type": "integer", "description": "状态码，0 表示成功" },
          "message": { "type": "string", "description": "提示信息" },
          "data": {
            "type": "object",
            "properties": {
              "user": { "type": "object", "description": "User 节点（仅节点本身）", "additionalProperties": true }
            }
          }
        }
      }
    },
    {
      "name": "falkordb_user_pin_ids",
      "description": "分页查询该用户发布的 Pin ID 列表，返回总数与当前页。",
      "method": "GET",
      "path": "/falkordb/users/{metaID}/pins",
      "request": {
        "pathParameters": [{ "name": "metaID", "type": "string", "required": true, "description": "用户 MetaID" }],
        "queryParameters": [
          { "name": "offset", "type": "integer", "required": false, "description": "偏移，默认 0" },
          { "name": "limit", "type": "integer", "required": false, "description": "每页条数，默认 20，最大 1000" }
        ]
      },
      "response": {
        "success": {
          "code": { "type": "integer", "description": "状态码，0 表示成功" },
          "message": { "type": "string", "description": "提示信息" },
          "data": {
            "type": "object",
            "properties": {
              "metaID": { "type": "string", "description": "用户 MetaID" },
              "total": { "type": "integer", "description": "该用户 Pin 总数" },
              "pinIDs": { "type": "array", "description": "当前页 pinID 列表", "items": { "type": "string" } },
              "offset": { "type": "integer", "description": "本次偏移" },
              "limit": { "type": "integer", "description": "本次每页条数" },
              "count": { "type": "integer", "description": "当前页条数" }
            }
          }
        }
      }
    },
    {
      "name": "falkordb_content_node",
      "description": "根据 pinID 查询 Content 节点及其关联的 User 和 PIN。",
      "method": "GET",
      "path": "/falkordb/contents/{pinID}",
      "request": {
        "pathParameters": [{ "name": "pinID", "type": "string", "required": true, "description": "PinID" }],
        "queryParameters": []
      },
      "response": {
        "success": {
          "code": { "type": "integer", "description": "状态码，0 表示成功" },
          "message": { "type": "string", "description": "提示信息" },
          "data": { "type": "object", "description": "Content 节点及关联 users、pins", "additionalProperties": true }
        }
      }
    },
    {
      "name": "falkordb_pin_node",
      "description": "根据 pinID 查询 PIN 节点及其关联的 User 和 Content。",
      "method": "GET",
      "path": "/falkordb/pins/{pinID}",
      "request": {
        "pathParameters": [{ "name": "pinID", "type": "string", "required": true, "description": "PinID" }],
        "queryParameters": []
      },
      "response": {
        "success": {
          "code": { "type": "integer", "description": "状态码，0 表示成功" },
          "message": { "type": "string", "description": "提示信息" },
          "data": { "type": "object", "description": "PIN 节点及关联 users、contents", "additionalProperties": true }
        }
      }
    }
  ]
}
